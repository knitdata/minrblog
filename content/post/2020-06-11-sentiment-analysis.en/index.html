---
title: 'TF-IDF & Sentiment Analysis '
author: Minr
date: '2020-06-11'
slug: sentiment-analysis
categories: []
tags:
  - NLP
subtitle: ''
summary: ''
authors: []
lastmod: '2020-06-11T22:46:01-07:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---



<div id="tf-idf-on-gutenberg-books" class="section level3">
<h3>TF-IDF on Gutenberg books</h3>
<p>TF is the normalized term frequency and IDF is the inverse document frequency. The TF-IDF is computed by multiplying two terms:TF and IDF
Therefore, the formula for TF-IDF is TFxIDF.</p>
<p>TF-IDF can be used for ranking important documents(page ranking). For example when we google a term COVID-19, the results are displayed in order of relevance. TF-IDF gives searched word(COVID-19) a higher score.</p>
<pre class="r"><code>library(pacman)
p_load(gutenbergr,tidyr,tidyverse,tidytext,forcats,
       genius)</code></pre>
<pre class="r"><code>#books on mathematics from project glutenberg
math_books &lt;- gutenberg_download(c(16449,25664,17001,16713), meta_fields = &quot;title&quot;)</code></pre>
<pre><code>## Determining mirror for Project Gutenberg from http://www.gutenberg.org/robot/harvest</code></pre>
<pre><code>## Using mirror http://aleph.gutenberg.org</code></pre>
<pre class="r"><code>#frequencies of words in each book
math_words &lt;- math_books %&gt;% 
  unnest_tokens(word, text) %&gt;% count(title, word, sort = TRUE)
math_words</code></pre>
<pre><code>## # A tibble: 24,655 x 3
##    title                                                 word      n
##    &lt;chr&gt;                                                 &lt;chr&gt; &lt;int&gt;
##  1 Amusements in Mathematics                             the   12480
##  2 Amusements in Mathematics                             of     4908
##  3 Amusements in Mathematics                             and    3921
##  4 Amusements in Mathematics                             a      3833
##  5 Amusements in Mathematics                             in     3672
##  6 Amusements in Mathematics                             to     3598
##  7 The Number Concept: Its Origin and Development        the    3177
##  8 An Elementary Course in Synthetic Projective Geometry the    2750
##  9 The Earliest Arithmetics in English                   e      2579
## 10 Amusements in Mathematics                             is     2542
## # … with 24,645 more rows</code></pre>
<pre class="r"><code>#tf-idf
tfidf_mathbooks &lt;- math_words %&gt;%
  bind_tf_idf(word, title, n) %&gt;%
  mutate(word = fct_reorder(word, tf_idf)) %&gt;%
  mutate(title = factor(title, levels = c( &quot;The Number Concept: Its Origin and Development&quot;,&quot;The Earliest Arithmetics in English&quot;, &quot;An Elementary Course in Synthetic Projective Geometry&quot;,&quot;Amusements in Mathematics&quot;)))
tfidf_mathbooks</code></pre>
<pre><code>## # A tibble: 24,655 x 6
##    title                                         word      n     tf   idf tf_idf
##    &lt;fct&gt;                                         &lt;fct&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 Amusements in Mathematics                     the   12480 0.0753 0     0     
##  2 Amusements in Mathematics                     of     4908 0.0296 0     0     
##  3 Amusements in Mathematics                     and    3921 0.0237 0     0     
##  4 Amusements in Mathematics                     a      3833 0.0231 0     0     
##  5 Amusements in Mathematics                     in     3672 0.0222 0     0     
##  6 Amusements in Mathematics                     to     3598 0.0217 0     0     
##  7 The Number Concept: Its Origin and Developme… the    3177 0.0578 0     0     
##  8 An Elementary Course in Synthetic Projective… the    2750 0.0788 0     0     
##  9 The Earliest Arithmetics in English           e      2579 0.0527 0.288 0.0151
## 10 Amusements in Mathematics                     is     2542 0.0153 0     0     
## # … with 24,645 more rows</code></pre>
<pre class="r"><code>#bargraphs
tfidf_mathbooks %&gt;% 
  group_by(title) %&gt;% 
  top_n(15, tf_idf) %&gt;% 
  ungroup() %&gt;%
  mutate(word = reorder(word, tf_idf)) %&gt;%
  ggplot(aes(word, tf_idf, fill = title)) +
  geom_col(show.legend = FALSE) +
  labs(x = NULL, y = &quot;tf-idf&quot;) +
  facet_wrap(~title, ncol = 2, scales = &quot;free&quot;) +
  coord_flip() + ggtitle(&quot;Bargraphs of top 15 words&quot;)</code></pre>
<p><img src="/post/2020-06-11-sentiment-analysis.en/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Amusements in Mathematics - This book appears to be related to solving puzzle and game.</p>
<p>An Elementary Course in Synthetic Projective Geometry- It appears to be related to book about measuring angle and point, probably involve a lot of theories.</p>
<p>The Earliest Arithmetics in English - The terms are interesting. The words in various langauge in original form.</p>
<p>The Number Concept: Its Origin and Development - It appears to be related how counting and numbering originated. It is probably indicating use of fingers by tribes for counting.</p>
<p>*<strong>Same analysis using bigrams.</strong></p>
<pre class="r"><code># bigrams for the math books from previous problem
math_bigrams &lt;-  math_books %&gt;%
unnest_tokens(bigram, text, token = &quot;ngrams&quot;, n = 2)
math_bigrams</code></pre>
<pre><code>## # A tibble: 304,593 x 3
##    gutenberg_id title                                          bigram           
##           &lt;int&gt; &lt;chr&gt;                                          &lt;chr&gt;            
##  1        16449 The Number Concept: Its Origin and Development transcriber&#39;s no…
##  2        16449 The Number Concept: Its Origin and Development note the         
##  3        16449 The Number Concept: Its Origin and Development the following    
##  4        16449 The Number Concept: Its Origin and Development following errors 
##  5        16449 The Number Concept: Its Origin and Development errors found     
##  6        16449 The Number Concept: Its Origin and Development found in         
##  7        16449 The Number Concept: Its Origin and Development in the           
##  8        16449 The Number Concept: Its Origin and Development the original     
##  9        16449 The Number Concept: Its Origin and Development original have    
## 10        16449 The Number Concept: Its Origin and Development have been        
## # … with 304,583 more rows</code></pre>
<pre class="r"><code># count bigrams
math_bigrams %&gt;% count(bigram, sort = TRUE)</code></pre>
<pre><code>## # A tibble: 126,537 x 2
##    bigram       n
##    &lt;chr&gt;    &lt;int&gt;
##  1 of the    2866
##  2 in the    1850
##  3 o o       1044
##  4 to the     847
##  5 it is      758
##  6 and the    756
##  7 on the     677
##  8 the same   638
##  9 that the   627
## 10 to be      554
## # … with 126,527 more rows</code></pre>
<pre class="r"><code># separate and filter stop words
mathbigrams_separated &lt;- math_bigrams %&gt;%
separate(bigram, c(&quot;word1&quot;, &quot;word2&quot;), sep = &quot; &quot;)

mathbigrams_filtered &lt;- mathbigrams_separated %&gt;%
  filter(!word1 %in% stop_words$word) %&gt;%
  filter(!word2 %in% stop_words$word)

# new bigram counts
bigram_counts &lt;- mathbigrams_filtered %&gt;% 
  count(word1, word2, sort = TRUE)
bigram_counts</code></pre>
<pre><code>## # A tibble: 38,184 x 3
##    word1 word2     n
##    &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
##  1 1     2       217
##  2 2     3       176
##  3 3     4       167
##  4 4     5       123
##  5 2     1       114
##  6 5     6       113
##  7 ou    er      111
##  8 1     7       103
##  9 2     2       101
## 10 2     8       101
## # … with 38,174 more rows</code></pre>
<pre class="r"><code>#combine filtered words to form bigrams 
mathbigrams_united &lt;- mathbigrams_filtered %&gt;%
  unite(bigram, word1, word2, sep = &quot; &quot;)
mathbigrams_united</code></pre>
<pre><code>## # A tibble: 56,991 x 3
##    gutenberg_id title                                          bigram           
##           &lt;int&gt; &lt;chr&gt;                                          &lt;chr&gt;            
##  1        16449 The Number Concept: Its Origin and Development transcriber&#39;s no…
##  2        16449 The Number Concept: Its Origin and Development errors found     
##  3        16449 The Number Concept: Its Origin and Development 14th paragraph   
##  4        16449 The Number Concept: Its Origin and Development paragraph drop   
##  5        16449 The Number Concept: Its Origin and Development drop double      
##  6        16449 The Number Concept: Its Origin and Development double quote     
##  7        16449 The Number Concept: Its Origin and Development chapter iv       
##  8        16449 The Number Concept: Its Origin and Development iv 1st           
##  9        16449 The Number Concept: Its Origin and Development 1st paragraph    
## 10        16449 The Number Concept: Its Origin and Development chapter iv       
## # … with 56,981 more rows</code></pre>
<pre class="r"><code>bigram_tf_idf &lt;- mathbigrams_united %&gt;%
  count(title, bigram) %&gt;%
  bind_tf_idf(bigram, title, n) %&gt;%
  arrange(desc(tf_idf))
bigram_tf_idf</code></pre>
<pre><code>## # A tibble: 38,958 x 6
##    title                                  bigram         n      tf   idf  tf_idf
##    &lt;chr&gt;                                  &lt;chr&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 The Earliest Arithmetics in English    ou er        111 0.00929  1.39 0.0129 
##  2 The Earliest Arithmetics in English    fig ur        86 0.00720  1.39 0.00998
##  3 An Elementary Course in Synthetic Pro… _a_ _b_       31 0.00576  1.39 0.00799
##  4 The Earliest Arithmetics in English    ne er         58 0.00485  1.39 0.00673
##  5 An Elementary Course in Synthetic Pro… _b_ _c_       26 0.00483  1.39 0.00670
##  6 An Elementary Course in Synthetic Pro… line join…    22 0.00409  1.39 0.00567
##  7 The Number Concept: Its Origin and De… _op cit       70 0.00397  1.39 0.00550
##  8 An Elementary Course in Synthetic Pro… letter ga…    21 0.00390  1.39 0.00541
##  9 The Earliest Arithmetics in English    aft er        46 0.00385  1.39 0.00534
## 10 The Earliest Arithmetics in English    eu er         46 0.00385  1.39 0.00534
## # … with 38,948 more rows</code></pre>
<pre class="r"><code>#bargraphs
bigram_tf_idf %&gt;% 
  group_by(title) %&gt;% 
  top_n(15, tf_idf) %&gt;% 
  ungroup() %&gt;%
  mutate(bigram=reorder(bigram, tf_idf)) %&gt;%
  ggplot(aes(bigram, tf_idf, fill = title)) +
  geom_col(show.legend = FALSE) +
  labs(x = NULL, y = &quot;tf-idf&quot;) +
  facet_wrap(~title, ncol = 2, scales = &quot;free&quot;) +
  coord_flip() + ggtitle(&quot;Bargraphs of top 15 bigrams&quot;)</code></pre>
<p><img src="/post/2020-06-11-sentiment-analysis.en/index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="sentiment-analysis-on-the-songs-from-genius" class="section level3">
<h3>Sentiment analysis on the songs from Genius</h3>
<ol style="list-style-type: decimal">
<li>Aerosmith - I don’t want to miss a thing</li>
</ol>
<pre class="r"><code>#get song lyrics
aero_smith_i_don &lt;- genius_lyrics(artist = &quot;Aerosmith&quot;, song = &quot; I don&#39;t want to miss a thing&quot;)
aero_smith_i_don</code></pre>
<pre><code>## # A tibble: 59 x 3
##    track_title                line lyric                                        
##    &lt;chr&gt;                     &lt;int&gt; &lt;chr&gt;                                        
##  1 I Don’t Want to Miss a T…     1 I could stay awake just to hear you breathin&#39;
##  2 I Don’t Want to Miss a T…     2 Watch you smile while you are sleeping       
##  3 I Don’t Want to Miss a T…     3 While you&#39;re far away and dreaming           
##  4 I Don’t Want to Miss a T…     4 I could spend my life in this sweet surrender
##  5 I Don’t Want to Miss a T…     5 I could stay lost in this moment forever     
##  6 I Don’t Want to Miss a T…     6 Where every moment spent with you is a momen…
##  7 I Don’t Want to Miss a T…     7 Don&#39;t want to close my eyes                  
##  8 I Don’t Want to Miss a T…     8 I don&#39;t want to fall asleep                  
##  9 I Don’t Want to Miss a T…     9 &#39;Cause I&#39;d miss you, baby                    
## 10 I Don’t Want to Miss a T…    10 And I don&#39;t wanna miss a thing               
## # … with 49 more rows</code></pre>
<pre class="r"><code>#tidy up lyrics
i_dont_tidy &lt;- aero_smith_i_don  %&gt;% select(lyric, track_title) %&gt;% unnest_tokens(word, lyric)
i_dont_tidy</code></pre>
<pre><code>## # A tibble: 390 x 2
##    track_title                  word    
##    &lt;chr&gt;                        &lt;chr&gt;   
##  1 I Don’t Want to Miss a Thing i       
##  2 I Don’t Want to Miss a Thing could   
##  3 I Don’t Want to Miss a Thing stay    
##  4 I Don’t Want to Miss a Thing awake   
##  5 I Don’t Want to Miss a Thing just    
##  6 I Don’t Want to Miss a Thing to      
##  7 I Don’t Want to Miss a Thing hear    
##  8 I Don’t Want to Miss a Thing you     
##  9 I Don’t Want to Miss a Thing breathin
## 10 I Don’t Want to Miss a Thing watch   
## # … with 380 more rows</code></pre>
<pre class="r"><code># join with sentiment lexicon
i_dont_sentiments&lt;- i_dont_tidy%&gt;%
inner_join(get_sentiments(&quot;bing&quot;), by = c(word = &quot;word&quot;))
i_dont_sentiments</code></pre>
<pre><code>## # A tibble: 35 x 3
##    track_title                  word      sentiment
##    &lt;chr&gt;                        &lt;chr&gt;     &lt;chr&gt;    
##  1 I Don’t Want to Miss a Thing smile     positive 
##  2 I Don’t Want to Miss a Thing sweet     positive 
##  3 I Don’t Want to Miss a Thing surrender negative 
##  4 I Don’t Want to Miss a Thing lost      negative 
##  5 I Don’t Want to Miss a Thing treasure  positive 
##  6 I Don’t Want to Miss a Thing fall      negative 
##  7 I Don’t Want to Miss a Thing miss      negative 
##  8 I Don’t Want to Miss a Thing miss      negative 
##  9 I Don’t Want to Miss a Thing miss      negative 
## 10 I Don’t Want to Miss a Thing miss      negative 
## # … with 25 more rows</code></pre>
<pre class="r"><code>#bargraph word-sentiment
i_dont_sentiments %&gt;%
  count(sentiment, word) %&gt;%
  ungroup() %&gt;%
  mutate(n = ifelse(sentiment == &quot;negative&quot;, -n, n)) %&gt;%
  mutate(word = reorder(word, n)) %&gt;%
  ggplot(aes(word, n, fill = sentiment)) +
  geom_bar(stat = &quot;identity&quot;) +
  ylab(&quot;Contribution to sentiment&quot;) +
  coord_flip()</code></pre>
<p><img src="/post/2020-06-11-sentiment-analysis.en/index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>The Weeknd - Earned It</li>
</ol>
<pre class="r"><code>the_weeknd_earned_it &lt;- genius_lyrics(artist = &quot;The Weeknd&quot;, song = &quot;Earned It&quot;)
the_weeknd_earned_it</code></pre>
<pre><code>## # A tibble: 51 x 3
##    track_title                     line lyric                                   
##    &lt;chr&gt;                          &lt;int&gt; &lt;chr&gt;                                   
##  1 Earned It (Fifty Shades of Gr…     1 I&#39;ma care for you                       
##  2 Earned It (Fifty Shades of Gr…     2 I&#39;ma care for you, you, you, you        
##  3 Earned It (Fifty Shades of Gr…     3 You make it look like it&#39;s magic (Oh ye…
##  4 Earned It (Fifty Shades of Gr…     4 &#39;Cause I see nobody, nobody but you, yo…
##  5 Earned It (Fifty Shades of Gr…     5 I&#39;m never confused                      
##  6 Earned It (Fifty Shades of Gr…     6 Hey, hey                                
##  7 Earned It (Fifty Shades of Gr…     7 I&#39;m so used to bein&#39; used               
##  8 Earned It (Fifty Shades of Gr…     8 So I love when you call unexpected      
##  9 Earned It (Fifty Shades of Gr…     9 &#39;Cause I hate when the moment&#39;s expected
## 10 Earned It (Fifty Shades of Gr…    10 So I&#39;ma care for you, you, you          
## # … with 41 more rows</code></pre>
<pre class="r"><code>earned_it_tidy &lt;- the_weeknd_earned_it  %&gt;% select(lyric, track_title) %&gt;% unnest_tokens(word, lyric)
earned_it_tidy</code></pre>
<pre><code>## # A tibble: 325 x 2
##    track_title                      word 
##    &lt;chr&gt;                            &lt;chr&gt;
##  1 Earned It (Fifty Shades of Grey) i&#39;ma 
##  2 Earned It (Fifty Shades of Grey) care 
##  3 Earned It (Fifty Shades of Grey) for  
##  4 Earned It (Fifty Shades of Grey) you  
##  5 Earned It (Fifty Shades of Grey) i&#39;ma 
##  6 Earned It (Fifty Shades of Grey) care 
##  7 Earned It (Fifty Shades of Grey) for  
##  8 Earned It (Fifty Shades of Grey) you  
##  9 Earned It (Fifty Shades of Grey) you  
## 10 Earned It (Fifty Shades of Grey) you  
## # … with 315 more rows</code></pre>
<pre class="r"><code>earned_it_sentiments&lt;- earned_it_tidy%&gt;%
inner_join(get_sentiments(&quot;bing&quot;), by = c(word = &quot;word&quot;))
earned_it_sentiments</code></pre>
<pre><code>## # A tibble: 36 x 3
##    track_title                      word       sentiment
##    &lt;chr&gt;                            &lt;chr&gt;      &lt;chr&gt;    
##  1 Earned It (Fifty Shades of Grey) like       positive 
##  2 Earned It (Fifty Shades of Grey) magic      positive 
##  3 Earned It (Fifty Shades of Grey) confused   negative 
##  4 Earned It (Fifty Shades of Grey) love       positive 
##  5 Earned It (Fifty Shades of Grey) unexpected negative 
##  6 Earned It (Fifty Shades of Grey) hate       negative 
##  7 Earned It (Fifty Shades of Grey) perfect    positive 
##  8 Earned It (Fifty Shades of Grey) worth      positive 
##  9 Earned It (Fifty Shades of Grey) work       positive 
## 10 Earned It (Fifty Shades of Grey) love       positive 
## # … with 26 more rows</code></pre>
<pre class="r"><code>earned_it_sentiments %&gt;%
  count(sentiment, word) %&gt;%
  ungroup() %&gt;%
  mutate(n = ifelse(sentiment == &quot;negative&quot;, -n, n)) %&gt;%
  mutate(word = reorder(word, n)) %&gt;%
  ggplot(aes(word, n, fill = sentiment)) +
  geom_bar(stat = &quot;identity&quot;) +
  ylab(&quot;Contribution to sentiment&quot;) +
  coord_flip()</code></pre>
<p><img src="/post/2020-06-11-sentiment-analysis.en/index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Pharrell Williams - Happy</li>
</ol>
<pre class="r"><code>pharrell_will_happy &lt;- genius_lyrics(artist = &quot;Pharrell Williams&quot;, song = &quot;Happy&quot;)
pharrell_will_happy</code></pre>
<pre><code>## # A tibble: 67 x 3
##    track_title  line lyric                                             
##    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;                                             
##  1 Happy           1 &lt;NA&gt;                                              
##  2 Happy           2 It might seem crazy what I&#39;m &#39;bout to say         
##  3 Happy           3 Sunshine she&#39;s here, you can take a break         
##  4 Happy           4 I&#39;m a hot air balloon that could go to space      
##  5 Happy           5 With the air, like I don&#39;t care, baby, by the way 
##  6 Happy           6 (Because I&#39;m happy)                               
##  7 Happy           7 Clap along if you feel like a room without a roof 
##  8 Happy           8 (Because I&#39;m happy)                               
##  9 Happy           9 Clap along if you feel like happiness is the truth
## 10 Happy          10 (Because I&#39;m happy)                               
## # … with 57 more rows</code></pre>
<pre class="r"><code>happy_tidy &lt;- pharrell_will_happy  %&gt;% select(lyric, track_title) %&gt;% unnest_tokens(word, lyric)
happy_tidy</code></pre>
<pre><code>## # A tibble: 473 x 2
##    track_title word 
##    &lt;chr&gt;       &lt;chr&gt;
##  1 Happy       &lt;NA&gt; 
##  2 Happy       it   
##  3 Happy       might
##  4 Happy       seem 
##  5 Happy       crazy
##  6 Happy       what 
##  7 Happy       i&#39;m  
##  8 Happy       bout 
##  9 Happy       to   
## 10 Happy       say  
## # … with 463 more rows</code></pre>
<pre class="r"><code>happy_sentiments&lt;- happy_tidy%&gt;%
inner_join(get_sentiments(&quot;bing&quot;), by = c(word = &quot;word&quot;))
happy_sentiments</code></pre>
<pre><code>## # A tibble: 63 x 3
##    track_title word      sentiment
##    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;    
##  1 Happy       crazy     negative 
##  2 Happy       break     negative 
##  3 Happy       hot       positive 
##  4 Happy       like      positive 
##  5 Happy       happy     positive 
##  6 Happy       like      positive 
##  7 Happy       happy     positive 
##  8 Happy       like      positive 
##  9 Happy       happiness positive 
## 10 Happy       happy     positive 
## # … with 53 more rows</code></pre>
<pre class="r"><code>happy_sentiments %&gt;%
  count(sentiment, word) %&gt;%
  ungroup() %&gt;%
  mutate(n = ifelse(sentiment == &quot;negative&quot;, -n, n)) %&gt;%
  mutate(word = reorder(word, n)) %&gt;%
  ggplot(aes(word, n, fill = sentiment)) +
  geom_bar(stat = &quot;identity&quot;) +
  ylab(&quot;Contribution to sentiment&quot;) +
  coord_flip()</code></pre>
<p><img src="/post/2020-06-11-sentiment-analysis.en/index_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Summertime Sadness – Lana Del Rey</li>
</ol>
<pre class="r"><code> Summertime_Sadness &lt;- genius_lyrics(artist = &quot;Lana Del Rey&quot;, song = &quot;Summertime Sadness&quot;)
Summertime_Sadness</code></pre>
<pre><code>## # A tibble: 54 x 3
##    track_title         line lyric                                          
##    &lt;chr&gt;              &lt;int&gt; &lt;chr&gt;                                          
##  1 Summertime Sadness     1 Kiss me hard before you go                     
##  2 Summertime Sadness     2 Summertime sadness                             
##  3 Summertime Sadness     3 I just wanted you to know                      
##  4 Summertime Sadness     4 That, baby, you&#39;re the best                    
##  5 Summertime Sadness     5 I got my red dress on tonight                  
##  6 Summertime Sadness     6 Dancin&#39; in the dark in the pale moonlight      
##  7 Summertime Sadness     7 Done my hair up real big, beauty queen style   
##  8 Summertime Sadness     8 High heels off, I&#39;m feelin&#39; alive              
##  9 Summertime Sadness     9 Oh, my God, I feel it in the air               
## 10 Summertime Sadness    10 Telephone wires above are sizzlin&#39; like a snare
## # … with 44 more rows</code></pre>
<pre class="r"><code>Summertime_Sadness_tidy &lt;- Summertime_Sadness %&gt;% select(lyric, track_title) %&gt;% unnest_tokens(word, lyric)
Summertime_Sadness_tidy</code></pre>
<pre><code>## # A tibble: 312 x 2
##    track_title        word      
##    &lt;chr&gt;              &lt;chr&gt;     
##  1 Summertime Sadness kiss      
##  2 Summertime Sadness me        
##  3 Summertime Sadness hard      
##  4 Summertime Sadness before    
##  5 Summertime Sadness you       
##  6 Summertime Sadness go        
##  7 Summertime Sadness summertime
##  8 Summertime Sadness sadness   
##  9 Summertime Sadness i         
## 10 Summertime Sadness just      
## # … with 302 more rows</code></pre>
<pre class="r"><code>Summertime_Sadness_sentiments&lt;- Summertime_Sadness_tidy%&gt;%
inner_join(get_sentiments(&quot;bing&quot;), by = c(word = &quot;word&quot;))
Summertime_Sadness_sentiments</code></pre>
<pre><code>## # A tibble: 39 x 3
##    track_title        word    sentiment
##    &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;    
##  1 Summertime Sadness hard    negative 
##  2 Summertime Sadness sadness negative 
##  3 Summertime Sadness best    positive 
##  4 Summertime Sadness dark    negative 
##  5 Summertime Sadness pale    negative 
##  6 Summertime Sadness beauty  positive 
##  7 Summertime Sadness like    positive 
##  8 Summertime Sadness snare   negative 
##  9 Summertime Sadness hard    negative 
## 10 Summertime Sadness sadness negative 
## # … with 29 more rows</code></pre>
<pre class="r"><code>Summertime_Sadness_sentiments %&gt;%
  count(sentiment, word) %&gt;%
  ungroup() %&gt;%
  mutate(n = ifelse(sentiment == &quot;negative&quot;, -n, n)) %&gt;%
  mutate(word = reorder(word, n)) %&gt;%
  ggplot(aes(word, n, fill = sentiment)) +
  geom_bar(stat = &quot;identity&quot;) +
  ylab(&quot;Contribution to sentiment&quot;) +
  coord_flip()</code></pre>
<p><img src="/post/2020-06-11-sentiment-analysis.en/index_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
